<?xml version="1.0" encoding="UTF-8"?>
<!--
BackTestSys 回测系统配置文件
所有可调整参数的配置文档
-->
<config>
    <!-- ============================================================================
         数据配置 (Data Configuration)
         ============================================================================ -->
    <data>
        <!-- 市场数据文件路径，支持pickle格式和csv格式的数据文件 -->
        <path>data/sample.csv</path>
        
        <!-- 数据格式：pkl (pickle) 或 csv -->
        <format>csv</format>
    </data>

    <!-- ============================================================================
         Tape构建器配置 (Tape Builder Configuration)
         ============================================================================ -->
    <tape>
        <!-- 时间分配的基准权重 (无成交时的baseline)
             用于防止零长度段的产生，典型值: 1.0 -->
        <epsilon>1.0</epsilon>
        
        
        <!-- 时间缩放lambda参数
             用于控制事件早期/晚期的分布
             0.0 = 均匀分布 -->
        <time_scale_lambda>0.0</time_scale_lambda>
        
        
        <!-- 跟踪的价格档位数 (Top-K)，典型值: 5 (跟踪前5档) -->
        <top_k>5</top_k>
        
        <!-- tick_size: 最小价格变动单位 -->
        <tick_size>1.0</tick_size>
    </tape>

    <!-- ============================================================================
         交易所模拟器配置 (Exchange Simulator Configuration)
         ============================================================================ -->
    <exchange>
        <!-- 撤单前端比例 (phi)
             控制撤单发生在队列前端的比例
             取值范围: 0.0 ~ 1.0
             - 0.0 = 悲观假设 (撤单全部发生在队列后端)
             - 0.5 = 中性假设
             - 1.0 = 乐观假设 (撤单全部发生在队列前端) -->
        <cancel_front_ratio>0.5</cancel_front_ratio>
    </exchange>

    <!-- ============================================================================
         运行器配置 (Runner Configuration)
         ============================================================================ -->
    <runner>
        <!-- 策略 -> 交易所 的延迟 (订单发送延迟)
             单位: tick (每tick = 100ns)
             例如: 1000000 = 100ms -->
        <delay_out>0</delay_out>
        
        <!-- 交易所 -> 策略 的延迟 (回执接收延迟)
             单位: tick (每tick = 100ns) -->
        <delay_in>0</delay_in>
        
        <!-- 是否显示进度条 (需要安装tqdm) -->
        <show_progress>false</show_progress>
    </runner>

    <!-- ============================================================================
         投资组合配置 (Portfolio Configuration)
         ============================================================================ -->
    <portfolio>
        <!-- 初始现金 -->
        <initial_cash>100000.0</initial_cash>
    </portfolio>

    <!-- ============================================================================
         策略配置 (Strategy Configuration)
         ============================================================================ -->
    <strategy>
        <!-- 策略名称 -->
        <name>SimpleStrategyImpl</name>
        
        <!-- 策略特定参数 (可根据策略自定义) -->
        <params>
            <!-- 每隔多少个快照下单 -->
            <order_interval>10</order_interval>
            <!-- 最大活跃订单数 -->
            <max_active_orders>5</max_active_orders>
        </params>
    </strategy>

    <!-- ============================================================================
         回执记录器配置 (Receipt Logger Configuration)
         ============================================================================ -->
    <receipt_logger>
        <!-- 是否实时打印回执 -->
        <verbose>false</verbose>
        
        <!-- 回执保存路径 (可选，留空则不保存)
             可以是完整文件路径 (如 output/receipts.csv)
             也可以是文件夹路径 (如 output/)，程序会自动生成带时间戳的CSV文件名 -->
        <output_file></output_file>
    </receipt_logger>

    <!-- ============================================================================
         日志配置 (Logging Configuration)
         ============================================================================ -->
    <logging>
        <!-- 是否启用debug模式 -->
        <debug>false</debug>
        
        <!-- 日志保存路径 (可选，留空则不保存到文件)
             可以是完整文件路径 (如 output/backtest.log)
             也可以是文件夹路径 (如 output/)，程序会自动生成带时间戳的日志文件名 -->
        <log_file></log_file>
        
        <!-- 日志级别 (DEBUG, INFO, WARNING, ERROR) -->
        <level>INFO</level>
        
        <!-- 是否在终端打印日志 -->
        <console>true</console>
    </logging>

    <!-- ============================================================================
         快照处理配置 (Snapshot Processing Configuration)
         ============================================================================ -->
    <snapshot>
        <!-- 快照最小间隔 (tick单位)
             500ms = 5,000,000 ticks (每tick = 100ns) -->
        <min_interval_tick>5000000</min_interval_tick>
        
        <!-- 时间容差 (tick单位)
             用于处理RecvTick的时间抖动
             10ms = 100,000 ticks -->
        <tolerance_tick>100000</tolerance_tick>
    </snapshot>

    <!-- ============================================================================
         合约配置 (Contract Configuration)
         ============================================================================ -->
    <contract>
        <!-- 合约ID (用于从合约字典中查找对应合约信息) -->
        <contract_id></contract_id>
        
        <!-- 合约字典XML文件路径 (包含所有合约的详细信息)
             XML格式示例：
             <ContractDictionaryConfig>
                 <Contract>
                     <ContractId>IF2401</ContractId>
                     <TickSize>0.2</TickSize>
                     <ExchangeCode>CFFEX</ExchangeCode>
                     <TradingHours>
                         <TradingHour>
                             <StartTime>09:30:00</StartTime>
                             <EndTime>11:30:00</EndTime>
                         </TradingHour>
                         <TradingHour>
                             <StartTime>13:00:00</StartTime>
                             <EndTime>15:00:00</EndTime>
                         </TradingHour>
                     </TradingHours>
                 </Contract>
             </ContractDictionaryConfig>
        -->
        <contract_dictionary_path></contract_dictionary_path>
    </contract>
</config>
