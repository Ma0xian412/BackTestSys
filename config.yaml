# BackTestSys 回测系统配置文件
# 所有可调整参数的配置文档

# ============================================================================
# 数据配置 (Data Configuration)
# ============================================================================
data:
  # 市场数据文件路径
  # 支持pickle格式的数据文件
  path: "data/sample.pkl"

# ============================================================================
# Tape构建器配置 (Tape Builder Configuration)
# ============================================================================
tape:
  # ghost规则: lastvolsplit -> 单边映射规则
  # 可选值: "symmetric" | "proportion" | "single_bid" | "single_ask"
  # - symmetric: 对称分配，lastvolsplit量平分给bid和ask
  # - proportion: 按比例分配，由ghost_alpha控制
  # - single_bid: 全部分配给bid侧
  # - single_ask: 全部分配给ask侧
  ghost_rule: "symmetric"
  
  # ghost比例因子 (仅在ghost_rule="proportion"时生效)
  # 取值范围: 0.0 ~ 1.0
  # 0.0 = 全部分配给ask, 1.0 = 全部分配给bid
  ghost_alpha: 0.5
  
  # 时间分配的基准权重 (无成交时的baseline)
  # 用于防止零长度段的产生
  # 典型值: 1.0
  epsilon: 1.0
  
  # 段迭代次数 (已弃用，保留用于向后兼容)
  segment_iterations: 2
  
  # 时间缩放lambda参数
  # 用于控制事件早期/晚期的分布
  # 0.0 = 均匀分布
  time_scale_lambda: 0.0
  
  # 撤单前端比例 (phi)
  # 控制撤单发生在队列前端的比例
  # 取值范围: 0.0 ~ 1.0
  # - 0.0 = 悲观假设 (撤单全部发生在队列后端)
  # - 0.5 = 中性假设
  # - 1.0 = 乐观假设 (撤单全部发生在队列前端)
  cancel_front_ratio: 0.5
  
  # 穿越订单处理策略
  # 可选值: "reject" | "adjust" | "passive"
  # - reject: 拒绝穿越订单
  # - adjust: 调整价格到非穿越
  # - passive: 将穿越订单视为被动订单
  crossing_order_policy: "passive"
  
  # 跟踪的价格档位数 (Top-K)
  # 典型值: 5 (跟踪前5档)
  top_k: 5
  
  # tick_size: 最小价格变动单位
  tick_size: 1.0

# ============================================================================
# 交易所模拟器配置 (Exchange Simulator Configuration)
# ============================================================================
exchange:
  # 撤单前端比例 (phi)
  # 与tape.cancel_front_ratio含义相同
  # 控制撤单发生在队列前端的比例
  cancel_front_ratio: 0.5

# ============================================================================
# 运行器配置 (Runner Configuration)
# ============================================================================
runner:
  # 策略 -> 交易所 的延迟 (订单发送延迟)
  # 单位: tick (每tick = 100ns)
  # 例如: 1000000 = 100ms
  delay_out: 0
  
  # 交易所 -> 策略 的延迟 (回执接收延迟)
  # 单位: tick (每tick = 100ns)
  delay_in: 0
  
  # 是否显示进度条 (需要安装tqdm)
  show_progress: false

# ============================================================================
# 投资组合配置 (Portfolio Configuration)
# ============================================================================
portfolio:
  # 初始现金
  initial_cash: 100000.0

# ============================================================================
# 策略配置 (Strategy Configuration)
# ============================================================================
strategy:
  # 策略名称
  name: "SimpleStrategy"
  
  # 策略特定参数 (可根据策略自定义)
  # 以下为SimpleStrategy的默认参数示例
  params:
    # 每隔多少个快照下单
    order_interval: 10
    # 最大活跃订单数
    max_active_orders: 5

# ============================================================================
# 回执记录器配置 (Receipt Logger Configuration)
# ============================================================================
receipt_logger:
  # 是否实时打印回执
  verbose: false
  
  # 回执保存文件路径 (可选，留空则不保存)
  output_file: ""

# ============================================================================
# 日志配置 (Logging Configuration)
# ============================================================================
logging:
  # 是否启用debug模式
  debug: false
  
  # 日志文件路径 (可选，留空则不保存到文件)
  log_file: ""
  
  # 日志级别 (DEBUG, INFO, WARNING, ERROR)
  level: "INFO"

# ============================================================================
# 快照处理配置 (Snapshot Processing Configuration)
# ============================================================================
snapshot:
  # 快照最小间隔 (tick单位)
  # 500ms = 5,000,000 ticks (每tick = 100ns)
  min_interval_tick: 5000000
  
  # 时间容差 (tick单位)
  # 用于处理RecvTick的时间抖动
  # 10ms = 100,000 ticks
  tolerance_tick: 100000
